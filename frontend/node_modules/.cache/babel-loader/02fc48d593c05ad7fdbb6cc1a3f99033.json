{"ast":null,"code":"import _objectSpread from\"/home/german/PycharmProjects/komax_prettl/PrettlNKKomax/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import komaxApi from\"../DAL/komax/komax-api\";import handle401 from\"./handle401\";var initialState={isFetching:false,isValid:true,numberErrMsg:\"\",idErrMsg:\"\"};var TOGGLE_FETCHING=\"MODAL/FETCHING\";var SET_VALID=\"MODAL/SET_VALID\";var SET_NUMBER_ERR_MSG=\"MODAL/NUMBER_MSG\";var SET_ID_ERR_MSG=\"MODAL/ID_MSG\";var modalReducer=function modalReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var stateCopy=_objectSpread({},state);switch(action.type){case TOGGLE_FETCHING:{stateCopy.isFetching=!stateCopy.isFetching;break;}case SET_VALID:{stateCopy.isValid=action.isValid;break;}case SET_ID_ERR_MSG:{stateCopy.idErrMsg=action.idErrMsg;break;}case SET_NUMBER_ERR_MSG:{stateCopy.numberErrMsg=action.numberErrMsg;break;}}return stateCopy;};var toggleFetchingAC=function toggleFetchingAC(){return{type:TOGGLE_FETCHING};};var setValidAC=function setValidAC(isValid){return{type:SET_VALID,isValid:isValid};};var setIdErrMsgAC=function setIdErrMsgAC(errMsg){return{type:SET_ID_ERR_MSG,idErrMsg:errMsg};};var setNumberErrMsgAC=function setNumberErrMsgAC(errMsg){return{type:SET_NUMBER_ERR_MSG,numberErrMsg:errMsg};};var checkValidThunk=function checkValidThunk(number){return function(dispatch){dispatch(toggleFetchingAC());komaxApi.getKomaxList().then(function(data){dispatch(toggleFetchingAC());var numberSet=data.map(function(elem){return elem.number;});if(numberSet.includes(number)){dispatch(setNumberErrMsgAC(\"Komax с данным номером уже существует\"));dispatch(setIdErrMsgAC(\"\"));dispatch(setValidAC(false));}else if(number===0){dispatch(setNumberErrMsgAC(\"Заполните поле `Komax number`\"));dispatch(setIdErrMsgAC(\"\"));dispatch(setValidAC(false));}else{dispatch(setValidAC(true));dispatch(setIdErrMsgAC(\"\"));dispatch(setNumberErrMsgAC(\"\"));}}).catch(function(err){handle401(err,dispatch);});};};export{modalReducer,checkValidThunk};","map":{"version":3,"sources":["/home/german/PycharmProjects/komax_prettl/PrettlNKKomax/frontend/src/reducers/modalReducer.js"],"names":["komaxApi","handle401","initialState","isFetching","isValid","numberErrMsg","idErrMsg","TOGGLE_FETCHING","SET_VALID","SET_NUMBER_ERR_MSG","SET_ID_ERR_MSG","modalReducer","state","action","stateCopy","type","toggleFetchingAC","setValidAC","setIdErrMsgAC","errMsg","setNumberErrMsgAC","checkValidThunk","number","dispatch","getKomaxList","then","data","numberSet","map","elem","includes","catch","err"],"mappings":"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","sourcesContent":["import komaxApi from \"../DAL/komax/komax-api\";\nimport handle401 from \"./handle401\";\n\nlet initialState = {\n    isFetching : false,\n    isValid : true,\n    numberErrMsg : \"\",\n    idErrMsg : \"\"\n}\n\nconst TOGGLE_FETCHING = \"MODAL/FETCHING\";\nconst SET_VALID = \"MODAL/SET_VALID\";\nconst SET_NUMBER_ERR_MSG = \"MODAL/NUMBER_MSG\";\nconst SET_ID_ERR_MSG = \"MODAL/ID_MSG\";\n\nlet modalReducer = (state = initialState, action) => {\n    let stateCopy = {...state};\n    switch (action.type) {\n        case TOGGLE_FETCHING : {\n            stateCopy.isFetching = !stateCopy.isFetching;\n            break;\n        }\n        case SET_VALID : {\n            stateCopy.isValid = action.isValid;\n            break;\n        }\n        case SET_ID_ERR_MSG : {\n            stateCopy.idErrMsg = action.idErrMsg;\n            break;\n        }\n        case SET_NUMBER_ERR_MSG : {\n            stateCopy.numberErrMsg = action.numberErrMsg;\n            break;\n        }\n    }\n\n    return stateCopy;\n}\n\nlet toggleFetchingAC = () => {\n    return {\n        type : TOGGLE_FETCHING\n    }\n}\n\nlet setValidAC = (isValid) => {\n    return {\n        type : SET_VALID,\n        isValid : isValid\n    }\n}\n\nlet setIdErrMsgAC = (errMsg) => {\n    return {\n        type : SET_ID_ERR_MSG,\n        idErrMsg : errMsg\n    }\n}\n\nlet setNumberErrMsgAC = (errMsg) => {\n    return {\n        type : SET_NUMBER_ERR_MSG,\n        numberErrMsg : errMsg\n    }\n}\n\nlet checkValidThunk = (number) => {\n    return (dispatch) => {\n        dispatch(toggleFetchingAC());\n        komaxApi.getKomaxList()\n            .then(data => {\n               dispatch(toggleFetchingAC());\n               let numberSet = data.map(elem => elem.number);\n               if (numberSet.includes(number)){\n                   dispatch(setNumberErrMsgAC(\"Komax с данным номером уже существует\"));\n                   dispatch(setIdErrMsgAC(\"\"));\n                   dispatch(setValidAC(false));\n               } else if (number === 0){\n                   dispatch(setNumberErrMsgAC(\"Заполните поле `Komax number`\"));\n                   dispatch(setIdErrMsgAC(\"\"));\n                   dispatch(setValidAC(false));\n               } else {\n                  dispatch(setValidAC(true));\n                  dispatch(setIdErrMsgAC(\"\"));\n                  dispatch(setNumberErrMsgAC(\"\"));\n               }\n            })\n            .catch(err => {\n                handle401(err, dispatch);\n            });\n    }\n}\n\nexport {modalReducer, checkValidThunk}"]},"metadata":{},"sourceType":"module"}