{"ast":null,"code":"import _slicedToArray from\"/home/whatruska/PycharmProjects/PrettlNKKomax/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import classes from\"./ModalForm.module.css\";import createKomax from\"../../../DAL/models/komax\";import SaveButton from\"../../common/SaveButton/SaveButton\";import{FormattedMessage}from'react-intl';import{Multiselect}from'multiselect-react-dropdown';var ModalForm=function ModalForm(props){var _useState=useState(props.selected?props.selected.sepairing?props.selected.sepairing.trim().split(' ').filter(function(elem){return elem.length>0;}):[]:[]),_useState2=_slicedToArray(_useState,2),multiselectOptions=_useState2[0],setMultiselectOptions=_useState2[1];var currKomax=props.selected;if(!currKomax){currKomax=createKomax({});}var komaxNumberRef=React.createRef();var statusRef=React.createRef();var markingRef=React.createRef();var pairingRef=React.createRef();var collectData=function collectData(e){props.close();var multiArr=multiselectOptions;if(multiArr.length===0){multiArr=currKomax.sepairing.split(\" \");}var data={number:komaxNumberRef.current.value,group_of_square:multiArr.reduce(function(prev,elem){return prev+\" \"+elem;}).trim(),pairing:pairingRef.current.value,marking:markingRef.current.value,status:statusRef.current.value};props.send(data);};var isInEditMode=props.heading===\"Изменить существующий аппарат\";var isNumberValid=props.numberErrMsg.length===0;var isIdValid=props.idErrMsg.length===0;var check=function check(e){if(!isInEditMode){var number=Number(komaxNumberRef.current.value);props.checkValid(number);}};var handleChoose=function handleChoose(e){var arr=[];e.forEach(function(elem){arr.push(elem[\"id\"]);});setMultiselectOptions(arr);};var options=['0.5 - 1.0','1.5 - 2.5','4.0 - 6.0'].map(function(elem,index){return{name:elem,id:index+1};});return/*#__PURE__*/React.createElement(\"div\",{className:classes.ModalForm},/*#__PURE__*/React.createElement(\"div\",{className:classes.heading},/*#__PURE__*/React.createElement(\"h2\",null,props.heading),/*#__PURE__*/React.createElement(\"button\",{onClick:props.close,className:classes.closeBtn},\"X\")),/*#__PURE__*/React.createElement(\"div\",{className:classes.inputs},/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(FormattedMessage,{id:\"komax.number_label\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"\".concat(classes.input,\" \").concat(!isNumberValid?classes.invalidInput:\"\"),ref:komaxNumberRef,value:currKomax.number,onChange:check,disabled:isInEditMode})),isNumberValid?/*#__PURE__*/React.createElement(React.Fragment,null):/*#__PURE__*/React.createElement(\"div\",{className:classes.error},props.numberErrMsg),/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(FormattedMessage,{id:\"komax.status_label\"}),/*#__PURE__*/React.createElement(\"select\",{className:classes.select,ref:statusRef},/*#__PURE__*/React.createElement(\"option\",{value:1,selected:currKomax.status===1,className:classes.option},\"Works\"),/*#__PURE__*/React.createElement(\"option\",{value:2,selected:currKomax.status===0,className:classes.option},\"Repair\"),/*#__PURE__*/React.createElement(\"option\",{value:3,selected:currKomax.status===2,className:classes.option},\"Not working\"))),/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(FormattedMessage,{id:\"komax.marking_label\"}),/*#__PURE__*/React.createElement(\"select\",{className:classes.select,ref:markingRef},/*#__PURE__*/React.createElement(\"option\",{value:1,selected:currKomax.marking===1,className:classes.option},\"Black\"),/*#__PURE__*/React.createElement(\"option\",{value:2,selected:currKomax.marking===2,className:classes.option},\"White\"),/*#__PURE__*/React.createElement(\"option\",{value:3,selected:currKomax.marking===3,className:classes.option},\"Both\"))),/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(FormattedMessage,{id:\"komax.pairing_label\"}),/*#__PURE__*/React.createElement(\"select\",{className:classes.select,ref:pairingRef},/*#__PURE__*/React.createElement(\"option\",{value:1,selected:currKomax.pairing===1,className:classes.option},\"+\"),/*#__PURE__*/React.createElement(\"option\",{value:0,selected:currKomax.pairing===0,className:classes.option},\"-\"))),/*#__PURE__*/React.createElement(\"label\",null,/*#__PURE__*/React.createElement(FormattedMessage,{id:\"komax.group_of_square_label\"}),/*#__PURE__*/React.createElement(Multiselect,{options:options// Options to display in the dropdown\n,onSelect:handleChoose// Function will trigger on select event\n,onRemove:handleChoose// Function will trigger on remove event\n,selectedValues:multiselectOptions.map(function(elem){return options[new Number(elem)-1];}),displayValue:\"name\"// Property name to display in the dropdown options\n})),isIdValid?/*#__PURE__*/React.createElement(React.Fragment,null):/*#__PURE__*/React.createElement(\"div\",{className:classes.error},props.idErrMsg)),/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbar},/*#__PURE__*/React.createElement(SaveButton,{click:collectData,disable:props.isFetching||!props.isValid,value:/*#__PURE__*/React.createElement(FormattedMessage,{id:\"save_button_label\"})})));};export default ModalForm;","map":{"version":3,"sources":["/home/whatruska/PycharmProjects/PrettlNKKomax/frontend/src/comp/Komaxes/Modal/ModalForm.js"],"names":["React","useState","classes","createKomax","SaveButton","FormattedMessage","Multiselect","ModalForm","props","selected","sepairing","trim","split","filter","elem","length","multiselectOptions","setMultiselectOptions","currKomax","komaxNumberRef","createRef","statusRef","markingRef","pairingRef","collectData","e","close","multiArr","data","number","current","value","group_of_square","reduce","prev","pairing","marking","status","send","isInEditMode","heading","isNumberValid","numberErrMsg","isIdValid","idErrMsg","check","Number","checkValid","handleChoose","arr","forEach","push","options","map","index","name","id","closeBtn","inputs","input","invalidInput","error","select","option","toolbar","isFetching","isValid"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\nimport classes from \"./ModalForm.module.css\";\nimport createKomax from \"../../../DAL/models/komax\";\nimport SaveButton from \"../../common/SaveButton/SaveButton\";\nimport {FormattedMessage} from 'react-intl';\nimport { Multiselect } from 'multiselect-react-dropdown';\n\nlet ModalForm = (props) => {\n    let [multiselectOptions, setMultiselectOptions] = useState(props.selected ? (props.selected.sepairing ? props.selected.sepairing.trim().split(' ').filter(elem => elem.length > 0) : []) : []);\n\n    let currKomax = props.selected;\n    if (!currKomax){\n        currKomax = createKomax({});\n    }\n\n    let komaxNumberRef = React.createRef();\n    let statusRef = React.createRef();\n    let markingRef = React.createRef();\n    let pairingRef = React.createRef();\n\n    let collectData = (e) => {\n        props.close();\n        let multiArr = multiselectOptions;\n        if (multiArr.length === 0){\n            multiArr = currKomax.sepairing.split(\" \");\n        }\n        let data = {\n            number : komaxNumberRef.current.value,\n            group_of_square : multiArr.reduce((prev, elem) => {\n                return prev + \" \" + elem\n            }).trim(),\n            pairing : pairingRef.current.value,\n            marking : markingRef.current.value,\n            status : statusRef.current.value\n        }\n\n        props.send(data);\n    };\n\n    let isInEditMode = props.heading === \"Изменить существующий аппарат\";\n    let isNumberValid = props.numberErrMsg.length === 0;\n    let isIdValid = props.idErrMsg.length === 0;\n\n    let check = (e) => {\n        if (!isInEditMode){\n            let number = Number(komaxNumberRef.current.value);\n            props.checkValid(number);\n        }\n    }\n\n    let handleChoose = (e) => {\n        let arr = [];\n        e.forEach(elem => {\n            arr.push(elem[\"id\"]);\n        });\n        setMultiselectOptions(arr);\n    }\n\n    let options = ['0.5 - 1.0', '1.5 - 2.5', '4.0 - 6.0'].map((elem, index) => {\n        return (\n            {name : elem, id : index + 1}\n        )\n    });\n\n    return(\n        <div className={classes.ModalForm}>\n            <div className={classes.heading}>\n                <h2>{props.heading}</h2>\n                <button onClick={props.close} className={classes.closeBtn}>X</button>\n            </div>\n            <div className={classes.inputs}>\n                <label>\n                    <FormattedMessage id={\"komax.number_label\"}/>\n                    <input type={\"text\"} className={`${classes.input} ${!isNumberValid ? classes.invalidInput :\"\"}`} ref={komaxNumberRef} value={currKomax.number} onChange={check} disabled={isInEditMode}/>\n                </label>\n                {isNumberValid\n                    ? <></>\n                    : <div className={classes.error}>\n                        {props.numberErrMsg}\n                      </div>\n                }\n                <label>\n                    <FormattedMessage id={\"komax.status_label\"}/>\n                    <select className={classes.select} ref={statusRef}>\n                        <option value={1} selected={currKomax.status === 1} className={classes.option}>Works</option>\n                        <option value={2} selected={currKomax.status === 0} className={classes.option}>Repair</option>\n                        <option value={3} selected={currKomax.status === 2} className={classes.option}>Not working</option>\n                    </select>\n                </label>\n                <label>\n                    <FormattedMessage id={\"komax.marking_label\"}/>\n                    <select className={classes.select} ref={markingRef}>\n                        <option value={1} selected={currKomax.marking === 1} className={classes.option}>Black</option>\n                        <option value={2} selected={currKomax.marking === 2} className={classes.option}>White</option>\n                        <option value={3} selected={currKomax.marking === 3} className={classes.option}>Both</option>\n                    </select>\n                </label>\n                <label>\n                    <FormattedMessage id={\"komax.pairing_label\"}/>\n                    <select className={classes.select} ref={pairingRef}>\n                        <option value={1} selected={currKomax.pairing === 1} className={classes.option}>+</option>\n                        <option value={0} selected={currKomax.pairing === 0} className={classes.option}>-</option>\n                    </select>\n                </label>\n                <label>\n                    <FormattedMessage id={\"komax.group_of_square_label\"}/>\n                    <Multiselect\n                        options={options} // Options to display in the dropdown\n                        onSelect={handleChoose} // Function will trigger on select event\n                        onRemove={handleChoose} // Function will trigger on remove event\n                        selectedValues={multiselectOptions.map(elem => {\n                            return options[new Number(elem) - 1];\n                        })}\n                        displayValue=\"name\" // Property name to display in the dropdown options\n                    />\n                </label>\n                {isIdValid\n                    ? <></>\n                    : <div className={classes.error}>\n                        {props.idErrMsg}\n                      </div>\n                }\n            </div>\n            <div className={classes.toolbar}>\n                <SaveButton click={collectData} disable={props.isFetching || !props.isValid} value={<FormattedMessage id={\"save_button_label\"}/>}/>\n            </div>\n        </div>\n    );\n}\n\nexport default ModalForm;"]},"metadata":{},"sourceType":"module"}